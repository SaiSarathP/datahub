<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="search" type="application/opensearchdescription+xml" title="DataHub" href="/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600&display=swap"><title data-react-helmet="true">Deploying to AWS | DataHub</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://datahubproject.io/docs/deploy/aws"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Deploying to AWS | DataHub"><meta data-react-helmet="true" name="description" content="The following is a set of instructions to quickstart DataHub on AWS Elastic Kubernetes Service (EKS). Note, the guide"><meta data-react-helmet="true" property="og:description" content="The following is a set of instructions to quickstart DataHub on AWS Elastic Kubernetes Service (EKS). Note, the guide"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://datahubproject.io/docs/deploy/aws"><link data-react-helmet="true" rel="alternate" href="https://datahubproject.io/docs/deploy/aws" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://datahubproject.io/docs/deploy/aws" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.50b661b8.css">
<link rel="preload" href="/assets/js/runtime~main.9cd1f951.js" as="script">
<link rel="preload" href="/assets/js/main.0198f1b5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" style="background-color:#090a11;color:#ffffff" role="banner"><div class="announcementBarContent_3EUC"><div><img src="/img/acryl-logo-white-mark.svg"><p><strong>Managed DataHub</strong><span> &nbsp;Acryl Data delivers an easy to consume DataHub platform for the enterprise</span></p></div> <a href="https://www.acryldata.io/datahub-beta" target="_blank" class="button button--primary">Sign up for Managed DataHub →</a></div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/datahub-logo-color-light-horizontal.svg" alt="DataHub Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/datahub-logo-color-dark-horizontal.svg" alt="DataHub Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/docs/demo">Demo</a><a href="https://blog.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://feature-requests.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Feature Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/docs/roadmap">Roadmap</a><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__slack" aria-label="Slack"></a><a href="https://github.com/linkedin/datahub" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__github" aria-label="GitHub"></a><a href="https://www.youtube.com/channel/UC3qFQC5IiwR5fvWEqi_tJ5w" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__youtube" aria-label="YouTube"></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE" style="background-image:url(&quot;data:image/svg+xml,%3Csvg width=&#x27;18&#x27; height=&#x27;18&#x27; fill=&#x27;none&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3E%3Cpath d=&#x27;M15.556 9.784A6.065 6.065 0 0 1 14 9.987a5.948 5.948 0 0 1-4.235-1.752 6.02 6.02 0 0 1-1.548-5.792.75.75 0 0 0-.918-.917A7.51 7.51 0 0 0 3.93 3.462c-2.924 2.924-2.924 7.682 0 10.607a7.453 7.453 0 0 0 5.304 2.198c2.003 0 3.886-.78 5.302-2.197a7.505 7.505 0 0 0 1.937-3.368.75.75 0 0 0-.918-.918Zm-2.079 3.225a5.96 5.96 0 0 1-4.242 1.758 5.964 5.964 0 0 1-4.243-1.758 6.009 6.009 0 0 1 0-8.486 5.942 5.942 0 0 1 1.545-1.112 7.52 7.52 0 0 0 2.167 5.886 7.479 7.479 0 0 0 5.886 2.168 6.026 6.026 0 0 1-1.113 1.544Z&#x27; fill=&#x27;%23fff&#x27; opacity=&#x27;.5&#x27;/%3E%3C/svg%3E&quot;);width:18px;height:18px;margin:-4px 0 0 -4px"> </span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE" style="background-image:url(&quot;data:image/svg+xml,%3Csvg width=&#x27;18&#x27; height=&#x27;18&#x27; fill=&#x27;none&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3E%3Cg opacity=&#x27;.5&#x27; fill=&#x27;%23fff&#x27;%3E%3Cpath d=&#x27;M5.245 9A3.76 3.76 0 0 0 9 12.755 3.76 3.76 0 0 0 12.755 9 3.76 3.76 0 0 0 9 5.245 3.76 3.76 0 0 0 5.245 9ZM9 6.745A2.258 2.258 0 0 1 11.255 9 2.258 2.258 0 0 1 9 11.255 2.258 2.258 0 0 1 6.745 9 2.258 2.258 0 0 1 9 6.745Zm-.752 7.505h1.5v2.25h-1.5v-2.25Zm0-12.75h1.5v2.25h-1.5V1.5Zm-6.75 6.75h2.25v1.5h-2.25v-1.5Zm12.75 0h2.25v1.5h-2.25v-1.5ZM3.164 13.773l1.59-1.592 1.062 1.06-1.59 1.592-1.062-1.06ZM12.18 4.758l1.592-1.592 1.06 1.06-1.591 1.592-1.06-1.06ZM4.756 5.819l-1.59-1.592 1.06-1.06L5.818 4.76l-1.06 1.06ZM14.832 13.773l-1.06 1.06-1.592-1.591 1.06-1.06 1.592 1.59Z&#x27;/%3E%3C/g%3E%3C/svg%3E&quot;);width:18px;height:18px;margin:-4px 0 0 -4px"> </span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DataHub</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Metadata Ingestion</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Metadata Modeling</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">GraphQL API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Usage Guides</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Developer Guides</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Deployment Guides</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/kafka-config">Configuring Kafka</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker">Deploying with Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/deploy/kubernetes">Deploying with Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker/datahub-upgrade">Upgrade Docker Image</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/deploy/aws">Deploying to AWS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/deploy/gcp">Deploying to GCP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/deploy/confluent-cloud">Integrating with Confluent Cloud</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Community</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>AWS setup guide</h1></header><p>The following is a set of instructions to quickstart DataHub on AWS Elastic Kubernetes Service (EKS). Note, the guide
assumes that you do not have a kubernetes cluster set up. If you are deploying DataHub to an existing cluster, please
skip the corresponding sections.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="prerequisites">Prerequisites<a aria-hidden="true" class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h2><p>This guide requires the following tools:</p><ul><li><a href="https://kubernetes.io/docs/tasks/tools/" target="_blank" rel="noopener noreferrer">kubectl</a> to manage kubernetes resources</li><li><a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">helm</a> to deploy the resources based on helm charts. Note, we only support Helm
3.</li><li><a href="https://eksctl.io/introduction/#installation" target="_blank" rel="noopener noreferrer">eksctl</a> to create and manage clusters on EKS</li><li><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html" target="_blank" rel="noopener noreferrer">AWS CLI</a> to manage AWS resources</li></ul><p>To use the above tools, you need to set up AWS credentials by following
this <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html" target="_blank" rel="noopener noreferrer">guide</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="start-up-a-kubernetes-cluster-on-aws-eks">Start up a kubernetes cluster on AWS EKS<a aria-hidden="true" class="hash-link" href="#start-up-a-kubernetes-cluster-on-aws-eks" title="Direct link to heading">​</a></h2><p>Let’s follow this <a href="https://docs.aws.amazon.com/eks/latest/userguide/getting-started-eksctl.html" target="_blank" rel="noopener noreferrer">guide</a> to create a new
cluster using eksctl. Run the following command with cluster-name set to the cluster name of choice, and region set to
the AWS region you are operating on.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create cluster \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name &lt;&lt;cluster-name&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --region &lt;&lt;region&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --with-oidc \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --nodes=3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The command will provision an EKS cluster powered by 3 EC2 m3.large nodes and provision a VPC based networking layer.</p><p>If you are planning to run the storage layer (MySQL, Elasticsearch, Kafka) as pods in the cluster, you need at least 3
nodes. If you decide to use managed storage services, you can reduce the number of nodes or use m3.medium nodes to save
cost. Refer to this <a href="https://eksctl.io/usage/creating-and-managing-clusters/" target="_blank" rel="noopener noreferrer">guide</a> to further customize the cluster
before provisioning.</p><p>Note, OIDC setup is required for following this guide when setting up the load balancer.</p><p>Run <code>kubectl get nodes</code> to confirm that the cluster has been setup correctly. You should get results like below</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                                          STATUS   ROLES    AGE   VERSION</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-192-168-49-49.us-west-2.compute.internal   Ready    &lt;none&gt;   3h    v1.18.9-eks-d1db3c</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-192-168-64-56.us-west-2.compute.internal   Ready    &lt;none&gt;   3h    v1.18.9-eks-d1db3c</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip-192-168-8-126.us-west-2.compute.internal   Ready    &lt;none&gt;   3h    v1.18.9-eks-d1db3c</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="setup-datahub-using-helm">Setup DataHub using Helm<a aria-hidden="true" class="hash-link" href="#setup-datahub-using-helm" title="Direct link to heading">​</a></h2><p>Once the kubernetes cluster has been set up, you can deploy DataHub and it’s prerequisites using helm. Please follow the
steps in this <a href="/docs/deploy/kubernetes">guide</a></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="expose-endpoints-using-a-load-balancer">Expose endpoints using a load balancer<a aria-hidden="true" class="hash-link" href="#expose-endpoints-using-a-load-balancer" title="Direct link to heading">​</a></h2><p>Now that all the pods are up and running, you need to expose the datahub-frontend end point by setting
up <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/" target="_blank" rel="noopener noreferrer">ingress</a>. To do this, you need to first set up an
ingress controller. There are
many <a href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/" target="_blank" rel="noopener noreferrer">ingress controllers</a>  to choose
from, but here, we will follow
this <a href="https://docs.aws.amazon.com/eks/latest/userguide/aws-load-balancer-controller.html" target="_blank" rel="noopener noreferrer">guide</a> to set up the AWS
Application Load Balancer(ALB) Controller.</p><p>First, if you did not use eksctl to setup the kubernetes cluster, make sure to go through the prerequisites listed
<a href="https://docs.aws.amazon.com/eks/latest/userguide/alb-ingress.html" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Download the IAM policy document for allowing the controller to make calls to AWS APIs on your behalf.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl -o iam_policy.json https://raw.githubusercontent.com/kubernetes-sigs/aws-load-balancer-controller/v2.2.0/docs/install/iam_policy.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Create an IAM policy based on the policy document by running the following.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws iam create-policy \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --policy-name AWSLoadBalancerControllerIAMPolicy \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --policy-document file://iam_policy.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Use eksctl to create a service account that allows us to attach the above policy to kubernetes pods.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create iamserviceaccount \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --cluster=&lt;&lt;cluster-name&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --namespace=kube-system \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name=aws-load-balancer-controller \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --attach-policy-arn=arn:aws:iam::&lt;&lt;account-id&gt;&gt;:policy/AWSLoadBalancerControllerIAMPolicy \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --override-existing-serviceaccounts \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --approve      </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Install the TargetGroupBinding custom resource definition by running the following.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -k &quot;github.com/aws/eks-charts/stable/aws-load-balancer-controller//crds?ref=master&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Add the helm chart repository containing the latest version of the ALB controller.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm repo add eks https://aws.github.io/eks-charts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm repo update</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Install the controller into the kubernetes cluster by running the following.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm upgrade -i aws-load-balancer-controller eks/aws-load-balancer-controller \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --set clusterName=&lt;&lt;cluster-name&gt;&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --set serviceAccount.create=false \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --set serviceAccount.name=aws-load-balancer-controller \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -n kube-system</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Verify the install completed by running <code>kubectl get deployment -n kube-system aws-load-balancer-controller</code>. It should
return a result like the following.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                           READY   UP-TO-DATE   AVAILABLE   AGE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws-load-balancer-controller   2/2     2            2           142m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now that the controller has been set up, we can enable ingress by updating the values.yaml (or any other values.yaml
file used to deploy datahub). Change datahub-frontend values to the following.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub-frontend:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  enabled: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  image:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    repository: linkedin/datahub-frontend-react</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tag: &quot;latest&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ingress:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    enabled: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    annotations:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      kubernetes.io/ingress.class: alb</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/scheme: internet-facing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/target-type: instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/certificate-arn: &lt;&lt;certificate-arn&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/inbound-cidrs: 0.0.0.0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/listen-ports: &#x27;[{&quot;HTTP&quot;: 80}, {&quot;HTTPS&quot;:443}]&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      alb.ingress.kubernetes.io/actions.ssl-redirect: &#x27;{&quot;Type&quot;: &quot;redirect&quot;, &quot;RedirectConfig&quot;: { &quot;Protocol&quot;: &quot;HTTPS&quot;, &quot;Port&quot;: &quot;443&quot;, &quot;StatusCode&quot;: &quot;HTTP_301&quot;}}&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    hosts:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      - host: &lt;&lt;host-name&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        redirectPaths:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - path: /*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name: ssl-redirect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            port: use-annotation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        paths:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - /*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You need to request a certificate in the AWS Certificate Manager by following this
<a href="https://docs.aws.amazon.com/acm/latest/userguide/gs-acm-request-public.html" target="_blank" rel="noopener noreferrer">guide</a>, and replace certificate-arn with
the ARN of the new certificate. You also need to replace host-name with the hostname of choice like
demo.datahubproject.io.</p><p>After updating the yaml file, run the following to apply the updates.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm upgrade --install datahub datahub/datahub --values values.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Once the upgrade completes, run <code>kubectl get ingress</code> to verify the ingress setup. You should see a result like the
following.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                       CLASS    HOSTS                         ADDRESS                                                                 PORTS   AGE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub-datahub-frontend   &lt;none&gt;   demo.datahubproject.io   k8s-default-datahubd-80b034d83e-904097062.us-west-2.elb.amazonaws.com   80      3h5m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note down the elb address in the address column. Add the DNS CNAME record to the host domain pointing the host-name (
from above) to the elb address. DNS updates generally take a few minutes to an hour. Once that is done, you should be
able to access datahub-frontend through the host-name.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="use-aws-managed-services-for-the-storage-layer">Use AWS managed services for the storage layer<a aria-hidden="true" class="hash-link" href="#use-aws-managed-services-for-the-storage-layer" title="Direct link to heading">​</a></h2><p>Managing the storage services like MySQL, Elasticsearch, and Kafka as kubernetes pods requires a great deal of
maintenance workload. To reduce the workload, you can use managed services like AWS <a href="https://aws.amazon.com/rds" target="_blank" rel="noopener noreferrer">RDS</a>,
<a href="https://aws.amazon.com/elasticsearch-service/" target="_blank" rel="noopener noreferrer">Elasticsearch Service</a>, and <a href="https://aws.amazon.com/msk/" target="_blank" rel="noopener noreferrer">Managed Kafka</a>
as the storage layer for DataHub. Support for using AWS Neptune as graph DB is coming soon.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="rds">RDS<a aria-hidden="true" class="hash-link" href="#rds" title="Direct link to heading">​</a></h3><p>Provision a MySQL database in AWS RDS that shares the VPC with the kubernetes cluster or has VPC peering set up between
the VPC of the kubernetes cluster. Once the database is provisioned, you should be able to see the following page. Take
a note of the endpoint marked by the red box.</p><p><img alt="AWS RDS" src="/assets/images/aws-rds-bf6c0fee9db2d5bac76a8f5d2699f765.png"></p><p>First, add the DB password to kubernetes by running the following.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete secret mysql-secrets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create secret generic mysql-secrets --from-literal=mysql-root-password=&lt;&lt;password&gt;&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Update the sql settings under global in the values.yaml as follows.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  sql:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    datasource:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      host: &quot;&lt;&lt;rds-endpoint&gt;&gt;:3306&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      hostForMysqlClient: &quot;&lt;&lt;rds-endpoint&gt;&gt;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      port: &quot;3306&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      url: &quot;jdbc:mysql://&lt;&lt;rds-endpoint&gt;&gt;:3306/datahub?verifyServerCertificate=false&amp;useSSL=true&amp;useUnicode=yes&amp;characterEncoding=UTF-8&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      driver: &quot;com.mysql.jdbc.Driver&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      username: &quot;root&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      password:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        secretRef: mysql-secrets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        secretKey: mysql-root-password</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Run <code>helm upgrade --install datahub datahub/datahub --values values.yaml</code> to apply the changes.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="elasticsearch-service">Elasticsearch Service<a aria-hidden="true" class="hash-link" href="#elasticsearch-service" title="Direct link to heading">​</a></h3><p>Provision an elasticsearch domain running elasticsearch version 7.9 or above that shares the VPC with the kubernetes
cluster or has VPC peering set up between the VPC of the kubernetes cluster. Once the domain is provisioned, you should
be able to see the following page. Take a note of the endpoint marked by the red box.</p><p><img alt="AWS Elasticsearch Service" src="/assets/images/aws-elasticsearch-938752b80fce89de4b06290e50b04e1d.png"></p><p>Update the elasticsearch settings under global in the values.yaml as follows.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  elasticsearch:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    host: &lt;&lt;elasticsearch-endpoint&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    port: &quot;443&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    useSSL: &quot;true&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You can also allow communication via HTTP (without SSL) by using the settings below.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  elasticsearch:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    host: &lt;&lt;elasticsearch-endpoint&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    port: &quot;80&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If you have fine-grained access control enabled with basic authentication, first run the following to create a k8s
secret with the password.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete secret elasticsearch-secrets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create secret generic elasticsearch-secrets --from-literal=elasticsearch-password=&lt;&lt;password&gt;&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Then use the settings below.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  elasticsearch:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    host: &lt;&lt;elasticsearch-endpoint&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    port: &quot;443&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    useSSL: &quot;true&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    auth:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      username: &lt;&lt;username&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      password:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        secretRef: elasticsearch-secrets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        secretName: elasticsearch-password</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Lastly, you <strong>NEED</strong> to set the following env variable for <strong>elasticsearchSetupJob</strong>. AWS Elasticsearch/Opensearch
service uses OpenDistro version of Elasticsearch, which does not support the &quot;datastream&quot; functionality. As such, we use
a different way of creating time based indices.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  elasticsearchSetupJob:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    enabled: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    image:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      repository: linkedin/datahub-elasticsearch-setup</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      tag: &quot;***&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    extraEnvs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      - name: USE_AWS_ELASTICSEARCH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        value: &quot;true&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Run <code>helm upgrade --install datahub datahub/datahub --values values.yaml</code> to apply the changes.</p><p><strong>Note:</strong>
If you have a custom setup of elastic search cluster and are deploying through docker, you can modify the configurations in datahub to point to the specific ES instance -</p><ol><li>If you are using <code>docker quickstart</code> you can modify the hostname and port of the ES instance in docker compose quickstart files located <a href="https://github.com/linkedin/datahub/blob/master/docker/quickstart/" target="_blank" rel="noopener noreferrer">here</a>.<ol><li>Once you have modified the quickstart recipes you can run the quickstart command using a specific docker compose file. Sample command for that is - <code>datahub docker quickstart --quickstart-compose-file docker/quickstart/docker-compose-without-neo4j.quickstart.yml</code></li></ol></li><li>If you are not using quickstart recipes, you can modify environment variable in GMS to point to the ES instance. The env files for datahub-gms are located <a href="https://github.com/linkedin/datahub/blob/master/docker/datahub-gms/env/" target="_blank" rel="noopener noreferrer">here</a>.</li></ol><p>Further, you can find a list of properties supported to work with a custom ES instance <a href="https://github.com/linkedin/datahub/blob/master/metadata-service/factories/src/main/java/com/linkedin/gms/factory/common/ElasticsearchSSLContextFactory.java" target="_blank" rel="noopener noreferrer">here</a> and <a href="https://github.com/linkedin/datahub/blob/master/metadata-service/factories/src/main/java/com/linkedin/gms/factory/common/RestHighLevelClientFactory.java" target="_blank" rel="noopener noreferrer">here</a>.</p><p>A mapping between the property name used in the above two files and the name used in docker/env file can be found <a href="https://github.com/linkedin/datahub/blob/master/metadata-service/factories/src/main/resources/application.yml" target="_blank" rel="noopener noreferrer">here</a>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="managed-streaming-for-apache-kafka-msk">Managed Streaming for Apache Kafka (MSK)<a aria-hidden="true" class="hash-link" href="#managed-streaming-for-apache-kafka-msk" title="Direct link to heading">​</a></h3><p>Provision an MSK cluster that shares the VPC with the kubernetes cluster or has VPC peering set up between the VPC of
the kubernetes cluster. Once the domain is provisioned, click on the “View client information” button in the ‘Cluster
Summary” section. You should see a page like below. Take a note of the endpoints marked by the red boxes.</p><p><img alt="AWS MSK" src="/assets/images/aws-msk-b31bc0807c69c546974e922a2079cb1c.png"></p><p>Update the kafka settings under global in the values.yaml as follows.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kafka:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bootstrap:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      server: &quot;&lt;&lt;bootstrap-server endpoint&gt;&gt;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    zookeeper:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      server:  &quot;&lt;&lt;zookeeper endpoint&gt;&gt;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    schemaregistry:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      url: &quot;http://prerequisites-cp-schema-registry:8081&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    partitions: 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    replicationFactor: 3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note, the number of partitions and replicationFactor should match the number of bootstrap servers. This is by default 3
for AWS MSK.</p><p>Run <code>helm upgrade --install datahub datahub/datahub --values values.yaml</code> to apply the changes.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="aws-glue-schema-registry">AWS Glue Schema Registry<a aria-hidden="true" class="hash-link" href="#aws-glue-schema-registry" title="Direct link to heading">​</a></h3><p>You can use AWS Glue schema registry instead of the kafka schema registry. To do so, first provision an AWS Glue schema
registry in the &quot;Schema Registry&quot; tab in the AWS Glue console page.</p><p>Once the registry is provisioned, you can change helm chart as follows.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kafka:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bootstrap:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    zookeeper:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    schemaregistry:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      type: AWS_GLUE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      glue:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        region: &lt;&lt;AWS region of registry&gt;&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        registry: &lt;&lt;name of registry&gt;&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note, it will use the name of the topic as the schema name in the registry.</p><p>Before you update the pods, you need to give the k8s worker nodes the correct permissions to access the schema registry.</p><p>The minimum permissions required looks like this</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Statement&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Sid&quot;: &quot;VisualEditor0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Action&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetRegistry&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:ListRegistries&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:CreateSchema&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:UpdateSchema&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetSchema&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:ListSchemas&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:RegisterSchemaVersion&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetSchemaByDefinition&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetSchemaVersion&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetSchemaVersionsDiff&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:ListSchemaVersions&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:CheckSchemaVersionValidity&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:PutSchemaVersionMetadata&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:QuerySchemaVersionMetadata&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Resource&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;arn:aws:glue:*:795586375822:schema/*&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;arn:aws:glue:us-west-2:795586375822:registry/demo-shared&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Sid&quot;: &quot;VisualEditor1&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Action&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;glue:GetSchemaVersion&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Resource&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;*&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The latter part is required to have &quot;*&quot; as the resource because of an issue in the AWS Glue schema registry library.
Refer to <a href="https://github.com/awslabs/aws-glue-schema-registry/issues/68" target="_blank" rel="noopener noreferrer">this issue</a> for any updates.</p><p>Glue currently doesn&#x27;t support AWS Signature V4. As such, we cannot use service accounts to give permissions to access
the schema registry. The workaround is to give the above permission to the EKS worker node&#x27;s IAM role. Refer
to <a href="https://github.com/awslabs/aws-glue-schema-registry/issues/69" target="_blank" rel="noopener noreferrer">this issue</a> for any updates.</p><p>Run <code>helm upgrade --install datahub datahub/datahub --values values.yaml</code> to apply the changes.</p><p>Note, you will be seeing log &quot;Schema Version Id is null. Trying to register the schema&quot; on every request. This log is
misleading, so should be ignored. Schemas are cached, so it does not register a new version on every request (aka no
performance issues). This has been fixed by <a href="https://github.com/awslabs/aws-glue-schema-registry/pull/64" target="_blank" rel="noopener noreferrer">this PR</a> but
the code has not been released yet. We will update version once a new release is out.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/linkedin/datahub/blob/master/docs/deploy/aws.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/docker/datahub-upgrade"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->Upgrade Docker Image</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/deploy/gcp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deploying to GCP<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#start-up-a-kubernetes-cluster-on-aws-eks" class="table-of-contents__link toc-highlight">Start up a kubernetes cluster on AWS EKS</a></li><li><a href="#setup-datahub-using-helm" class="table-of-contents__link toc-highlight">Setup DataHub using Helm</a></li><li><a href="#expose-endpoints-using-a-load-balancer" class="table-of-contents__link toc-highlight">Expose endpoints using a load balancer</a></li><li><a href="#use-aws-managed-services-for-the-storage-layer" class="table-of-contents__link toc-highlight">Use AWS managed services for the storage layer</a><ul><li><a href="#rds" class="table-of-contents__link toc-highlight">RDS</a></li><li><a href="#elasticsearch-service" class="table-of-contents__link toc-highlight">Elasticsearch Service</a></li><li><a href="#managed-streaming-for-apache-kafka-msk" class="table-of-contents__link toc-highlight">Managed Streaming for Apache Kafka (MSK)</a></li><li><a href="#aws-glue-schema-registry" class="table-of-contents__link toc-highlight">AWS Glue Schema Registry</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Quickstart</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/features">Features</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faq">FAQs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC3qFQC5IiwR5fvWEqi_tJ5w" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://blog.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/townhalls">Town Halls</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/#adoption">Adoption</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/demo">Demo</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/roadmap">Roadmap</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/contributing">Contributing</a></li><li class="footer__item"><a href="https://github.com/linkedin/datahub" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://feature-requests.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Feature Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2015-2021 DataHub Project Authors.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9cd1f951.js"></script>
<script src="/assets/js/main.0198f1b5.js"></script>
</body>
</html>