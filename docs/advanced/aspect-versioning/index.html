<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="search" type="application/opensearchdescription+xml" title="DataHub" href="/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600&display=swap"><title data-react-helmet="true">Aspect Versioning | DataHub</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://datahubproject.io/docs/advanced/aspect-versioning"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Aspect Versioning | DataHub"><meta data-react-helmet="true" name="description" content="As each version of metadata aspect is immutable, any update to an existing aspect results in the creation of a new version. Typically one would expect the version number increases sequentially with the largest version number being the latest version, i.e. v1 (oldest), v2 (second oldest), ..., vN (latest). However, this approach results in major challenges in both rest.li modeling &amp; transaction isolation and therefore requires a rethinking."><meta data-react-helmet="true" property="og:description" content="As each version of metadata aspect is immutable, any update to an existing aspect results in the creation of a new version. Typically one would expect the version number increases sequentially with the largest version number being the latest version, i.e. v1 (oldest), v2 (second oldest), ..., vN (latest). However, this approach results in major challenges in both rest.li modeling &amp; transaction isolation and therefore requires a rethinking."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://datahubproject.io/docs/advanced/aspect-versioning"><link data-react-helmet="true" rel="alternate" href="https://datahubproject.io/docs/advanced/aspect-versioning" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://datahubproject.io/docs/advanced/aspect-versioning" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.50b661b8.css">
<link rel="preload" href="/assets/js/runtime~main.9cd1f951.js" as="script">
<link rel="preload" href="/assets/js/main.0198f1b5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" style="background-color:#090a11;color:#ffffff" role="banner"><div class="announcementBarContent_3EUC"><div><img src="/img/acryl-logo-white-mark.svg"><p><strong>Managed DataHub</strong><span> &nbsp;Acryl Data delivers an easy to consume DataHub platform for the enterprise</span></p></div> <a href="https://www.acryldata.io/datahub-beta" target="_blank" class="button button--primary">Sign up for Managed DataHub â†’</a></div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/datahub-logo-color-light-horizontal.svg" alt="DataHub Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/datahub-logo-color-dark-horizontal.svg" alt="DataHub Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/docs/demo">Demo</a><a href="https://blog.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://feature-requests.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Feature Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/docs/roadmap">Roadmap</a><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__slack" aria-label="Slack"></a><a href="https://github.com/linkedin/datahub" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__github" aria-label="GitHub"></a><a href="https://www.youtube.com/channel/UC3qFQC5IiwR5fvWEqi_tJ5w" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link item__icon item__youtube" aria-label="YouTube"></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE" style="background-image:url(&quot;data:image/svg+xml,%3Csvg width=&#x27;18&#x27; height=&#x27;18&#x27; fill=&#x27;none&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3E%3Cpath d=&#x27;M15.556 9.784A6.065 6.065 0 0 1 14 9.987a5.948 5.948 0 0 1-4.235-1.752 6.02 6.02 0 0 1-1.548-5.792.75.75 0 0 0-.918-.917A7.51 7.51 0 0 0 3.93 3.462c-2.924 2.924-2.924 7.682 0 10.607a7.453 7.453 0 0 0 5.304 2.198c2.003 0 3.886-.78 5.302-2.197a7.505 7.505 0 0 0 1.937-3.368.75.75 0 0 0-.918-.918Zm-2.079 3.225a5.96 5.96 0 0 1-4.242 1.758 5.964 5.964 0 0 1-4.243-1.758 6.009 6.009 0 0 1 0-8.486 5.942 5.942 0 0 1 1.545-1.112 7.52 7.52 0 0 0 2.167 5.886 7.479 7.479 0 0 0 5.886 2.168 6.026 6.026 0 0 1-1.113 1.544Z&#x27; fill=&#x27;%23fff&#x27; opacity=&#x27;.5&#x27;/%3E%3C/svg%3E&quot;);width:18px;height:18px;margin:-4px 0 0 -4px"> </span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE" style="background-image:url(&quot;data:image/svg+xml,%3Csvg width=&#x27;18&#x27; height=&#x27;18&#x27; fill=&#x27;none&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3E%3Cg opacity=&#x27;.5&#x27; fill=&#x27;%23fff&#x27;%3E%3Cpath d=&#x27;M5.245 9A3.76 3.76 0 0 0 9 12.755 3.76 3.76 0 0 0 12.755 9 3.76 3.76 0 0 0 9 5.245 3.76 3.76 0 0 0 5.245 9ZM9 6.745A2.258 2.258 0 0 1 11.255 9 2.258 2.258 0 0 1 9 11.255 2.258 2.258 0 0 1 6.745 9 2.258 2.258 0 0 1 9 6.745Zm-.752 7.505h1.5v2.25h-1.5v-2.25Zm0-12.75h1.5v2.25h-1.5V1.5Zm-6.75 6.75h2.25v1.5h-2.25v-1.5Zm12.75 0h2.25v1.5h-2.25v-1.5ZM3.164 13.773l1.59-1.592 1.062 1.06-1.59 1.592-1.062-1.06ZM12.18 4.758l1.592-1.592 1.06 1.06-1.591 1.592-1.06-1.06ZM4.756 5.819l-1.59-1.592 1.06-1.06L5.818 4.76l-1.06 1.06ZM14.832 13.773l-1.06 1.06-1.592-1.591 1.06-1.06 1.592 1.59Z&#x27;/%3E%3C/g%3E%3C/svg%3E&quot;);width:18px;height:18px;margin:-4px 0 0 -4px"> </span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DataHub</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Metadata Ingestion</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Metadata Modeling</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">GraphQL API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Usage Guides</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Developer Guides</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developers">Local Development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker/development">Using Docker Images During Development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/metadata-ingestion/adding-source">Adding a Metadata Ingestion Source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/metadata-ingestion/source_docs/s3">Ingesting files from S3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/auth/jaas">JaaS Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/auth/sso/configure-oidc-react">OIDC Authentication in React</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/auth/sso/configure-oidc-react-google">Configuring Google Authentication for React App (OIDC)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/auth/sso/configure-oidc-react-okta">Configuring Okta Authentication for React App (OIDC)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/restore-indices">Restoring Search and Graph Indices from Local Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/extract-container-logs">How to Extract Logs from DataHub Containers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/delete-metadata">Removing Metadata from DataHub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/datahub-web-react/src/app/analytics">React Analytics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/metadata-ingestion/developing">Developing on Metadata Ingestion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/add-custom-data-platform">Adding a custom Dataset Data Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/add-custom-ingestion-source">Using a Custom Ingestion Source</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Module READMEs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Advanced</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/no-code-modeling">No Code Metadata</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/advanced/aspect-versioning">Aspect Versioning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/es-7-upgrade">Elasticsearch upgrade from 5.6.8 to 7.9.3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/high-cardinality">High Cardinality Relationships</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/no-code-upgrade">No Code Upgrade (In-Place Migration Guide)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/how/migrating-graph-service-implementation">Migrate Graph Service Implementation to Elasticsearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/mcp-mcl">MetadataChangeProposal &amp; MetadataChangeLog Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/field-path-spec-v2">SchemaFieldPath Specification (Version 2)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/monitoring">Monitoring DataHub</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deployment Guides</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Community</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Aspect Versioning</h1></header><p>As each version of <a href="/docs/what/aspect">metadata aspect</a> is immutable, any update to an existing aspect results in the creation of a new version. Typically one would expect the version number increases sequentially with the largest version number being the latest version, i.e. <code>v1</code> (oldest), <code>v2</code> (second oldest), ..., <code>vN</code> (latest). However, this approach results in major challenges in both rest.li modeling &amp; transaction isolation and therefore requires a rethinking.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="restli-modeling">Rest.li Modeling<a aria-hidden="true" class="hash-link" href="#restli-modeling" title="Direct link to heading">â€‹</a></h2><p>As it&#x27;s common to create dedicated rest.li sub-resources for a specific aspect, e.g. <code>/datasets/{datasetKey}/ownership</code>, the concept of versions become an interesting modeling question. Should the sub-resource be a <a href="https://linkedin.github.io/rest.li/modeling/modeling#simple" target="_blank" rel="noopener noreferrer">Simple</a> or a <a href="https://linkedin.github.io/rest.li/modeling/modeling#collection" target="_blank" rel="noopener noreferrer">Collection</a> type?</p><p>If Simple, the <a href="https://linkedin.github.io/rest.li/user_guide/restli_server#get" target="_blank" rel="noopener noreferrer">GET</a> method is expected to return the latest version, and the only way to retrieve non-latest versions is through a custom <a href="https://linkedin.github.io/rest.li/user_guide/restli_server#action" target="_blank" rel="noopener noreferrer">ACTION</a> method, which is going against the <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="noopener noreferrer">REST</a> principle. As a result, a Simple sub-resource doesn&#x27;t seem to a be a good fit.</p><p>If Collection, the version number naturally becomes the key so it&#x27;s easy to retrieve specific version number using the typical GET method. It&#x27;s also easy to list all versions using the standard <a href="https://linkedin.github.io/rest.li/user_guide/restli_server#get_all" target="_blank" rel="noopener noreferrer">GET_ALL</a> method or get a set of versions via <a href="https://linkedin.github.io/rest.li/user_guide/restli_server#batch_get" target="_blank" rel="noopener noreferrer">BATCH_GET</a>. However, Collection resources don&#x27;t support a simple way to get the latest/largest key directly. To achieve that, one must do one of the following</p><ul><li>a GET_ALL (assuming descending key order) with a page size of 1</li><li>a <a href="https://linkedin.github.io/rest.li/user_guide/restli_server#finder" target="_blank" rel="noopener noreferrer">FINDER</a> with special parameters and a page size of 1</li><li>a custom ACTION method again</li></ul><p>None of these options seems like a natural way to ask for the latest version of an aspect, which is one of the most common use cases.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="transaction-isolation">Transaction Isolation<a aria-hidden="true" class="hash-link" href="#transaction-isolation" title="Direct link to heading">â€‹</a></h2><p><a href="https://en.wikipedia.org/wiki/Isolation_(database_systems)" target="_blank" rel="noopener noreferrer">Transaction isolation</a> is a complex topic so make sure to familiarize yourself with the basics first. </p><p>To support concurrent update of a metadata aspect, the following pseudo DB operations must be run in a single transaction,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">1. Retrieve the current max version (Vmax)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2. Write the new value as (Vmax + 1)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Operation 1 above can easily suffer from <a href="https://en.wikipedia.org/wiki/Isolation_(database_systems)#Phantom_reads" target="_blank" rel="noopener noreferrer">Phantom Reads</a>. This subsequently leads to Operation 2 computing the incorrect version and thus overwrites an existing version instead of creating a new one.</p><p>One way to solve this is by enforcing <a href="https://en.wikipedia.org/wiki/Isolation_(database_systems)#Serializable" target="_blank" rel="noopener noreferrer">Serializable</a> isolation level in DB at the <a href="https://logicalread.com/optimize-mysql-perf-part-2-mc13/#.XjxSRSlKh1N" target="_blank" rel="noopener noreferrer">cost of performance</a>. In reality, very few DB even supports this level of isolation, especially for distributed document stores. It&#x27;s more common to support <a href="https://en.wikipedia.org/wiki/Isolation_(database_systems)#Repeatable_reads" target="_blank" rel="noopener noreferrer">Repeatable Reads</a> or <a href="https://en.wikipedia.org/wiki/Isolation_(database_systems)#Read_committed" target="_blank" rel="noopener noreferrer">Read Committed</a> isolation levelsâ€”sadly neither would help in this case.</p><p>Another possible solution is to transactionally keep track of <code>Vmax</code> directly in a separate table to avoid the need to compute that through a <code>select</code> (thus prevent Phantom Reads). However, cross-table/document/entity transaction is not a feature supported by all distributed document stores, which precludes this as a generalized solution.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="solution-version-0">Solution: Version 0<a aria-hidden="true" class="hash-link" href="#solution-version-0" title="Direct link to heading">â€‹</a></h2><p>The solution to both challenges turns out to be surprisingly simple. Instead of using a &quot;floating&quot; version number to represent the latest version, one can use a &quot;fixed/sentinel&quot; version number instead. In this case we choose Version 0 as we want all non-latest versions to still keep increasing sequentially. In other words, it&#x27;d be <code>v0</code> (latest), <code>v1</code> (oldest), <code>v2</code> (second oldest), etc. Alternatively, you can also simply view all the non-zero versions as an audit trail.</p><p>Let&#x27;s examine how Version 0 can solve the aforementioned challenges.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="restli-modeling-1">Rest.li Modeling<a aria-hidden="true" class="hash-link" href="#restli-modeling-1" title="Direct link to heading">â€‹</a></h3><p>With Version 0, getting the latest version becomes calling the GET method of a Collection aspect-specific sub-resource with a deterministic key, e.g. <code>/datasets/{datasetkey}/ownership/0</code>, which is a lot more natural than using GET_ALL or FINDER.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="transaction-isolation-1">Transaction Isolation<a aria-hidden="true" class="hash-link" href="#transaction-isolation-1" title="Direct link to heading">â€‹</a></h3><p>The pseudo DB operations change to the following transaction block with version 0,</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">1. Retrieve v0 of the aspect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2. Retrieve the current max version (Vmax)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">3. Write the old value back as (Vmax + 1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">4. Write the new value back as v0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>While Operation 2 still suffers from potential Phantom Reads and thus corrupting existing version in Operation 3, Repeatable Reads isolation level will ensure that the transaction fails due to <a href="https://codingsight.com/the-lost-update-problem-in-concurrent-transactions/" target="_blank" rel="noopener noreferrer">Lost Update</a> detected in Operation 4. Note that this happens to also be the <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-transaction-isolation-levels.html" target="_blank" rel="noopener noreferrer">default isolation level</a> for InnoDB in MySQL.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/linkedin/datahub/blob/master/docs/advanced/aspect-versioning.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/advanced/no-code-modeling"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->No Code Metadata</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/advanced/es-7-upgrade"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Elasticsearch upgrade from 5.6.8 to 7.9.3<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#restli-modeling" class="table-of-contents__link toc-highlight">Rest.li Modeling</a></li><li><a href="#transaction-isolation" class="table-of-contents__link toc-highlight">Transaction Isolation</a></li><li><a href="#solution-version-0" class="table-of-contents__link toc-highlight">Solution: Version 0</a><ul><li><a href="#restli-modeling-1" class="table-of-contents__link toc-highlight">Rest.li Modeling</a></li><li><a href="#transaction-isolation-1" class="table-of-contents__link toc-highlight">Transaction Isolation</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Quickstart</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/features">Features</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faq">FAQs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://slack.datahubproject.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC3qFQC5IiwR5fvWEqi_tJ5w" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://blog.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/townhalls">Town Halls</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/#adoption">Adoption</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/demo">Demo</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/roadmap">Roadmap</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/contributing">Contributing</a></li><li class="footer__item"><a href="https://github.com/linkedin/datahub" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://feature-requests.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Feature Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2015-2021 DataHub Project Authors.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9cd1f951.js"></script>
<script src="/assets/js/main.0198f1b5.js"></script>
</body>
</html>